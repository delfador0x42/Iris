import Foundation

/// Known C2 domains and patterns from malware analysis.
public enum MalwareC2 {

    public static func indicators() -> [ThreatIndicator] {
        domains.map { entry in
            ThreatIndicator(
                type: .c2Domain,
                value: entry.domain,
                malwareFamily: entry.family,
                mitreId: "T1071",
                severity: .critical
            )
        }
    }

    private struct Entry { let domain: String; let family: String }

    private static let domains: [Entry] = [
        // CloudMensis — pCloud C2
        Entry(domain: "api.pcloud.com", family: "CloudMensis"),
        // Eleanor — Dropbox C2
        Entry(domain: "content.dropboxapi.com", family: "Eleanor"),
        // Calisto
        Entry(domain: "40.87.56.192", family: "Calisto"),
        // BeaverTail (DPRK)
        Entry(domain: "95.164.17.24", family: "BeaverTail"),
        // AppleJeus (DPRK/Lazarus)
        Entry(domain: "celasllc.com", family: "AppleJeus"),
        Entry(domain: "unioncrypto.vip", family: "AppleJeus"),
        Entry(domain: "jmttrading.org", family: "AppleJeus"),
        // BlueNoroff (DPRK)
        Entry(domain: "metamask.awaitingfor.site", family: "BlueNoroff"),
        // ColdRoot
        Entry(domain: "45.77.49.118", family: "ColdRoot"),
        // Banshee
        Entry(domain: "45.142.122.92", family: "Banshee"),
        // CloudChat
        Entry(domain: "45.77.179.89", family: "CloudChat"),
        // Activator DGA seed domains
        Entry(domain: "daaily.net", family: "Activator"),
        // XslCmd redirectors
        Entry(domain: "translate.google.com", family: "XslCmd"),
        // CookieMiner
        Entry(domain: "46.226.108.171", family: "CookieMiner"),
        Entry(domain: "koto-pool.work", family: "CookieMiner"),
        // OceanLotus (APT32)
        Entry(domain: "miaborsa.com", family: "OceanLotus"),
        Entry(domain: "sfrfrede.com", family: "OceanLotus"),
        // Dead drop resolvers — used by many families
        Entry(domain: "api.telegram.org", family: "DeadDrop"),
        Entry(domain: "steamcommunity.com", family: "DeadDrop"),
        Entry(domain: "pastebin.com", family: "DeadDrop"),
        Entry(domain: "raw.githubusercontent.com", family: "DeadDrop"),
        // Phexia
        Entry(domain: "api.telegram.org/bot", family: "Phexia"),
        // NotLockBit — AWS exfiltration
        Entry(domain: "s3.amazonaws.com", family: "NotLockBit"),
        // DarthMiner — cryptomining
        Entry(domain: "xmr.pool.minergate.com", family: "DarthMiner"),
        // iWorm — Reddit dead drop
        Entry(domain: "reddit.com/r/minecraftserverlists", family: "iWorm"),
        // Komplex (APT28)
        Entry(domain: "apple-icloud.net", family: "Komplex"),
        // LightSpy (APT41)
        Entry(domain: "103.27.109.217", family: "LightSpy"),
        // FlexibleFerret IP detection
        Entry(domain: "api.ipify.org", family: "FlexibleFerret"),
        Entry(domain: "freeipapi.com", family: "FlexibleFerret"),
        // EvilQuest
        Entry(domain: "167.71.237.219", family: "EvilQuest"),
        // Dacls (DPRK)
        Entry(domain: "185.62.58.207", family: "Dacls"),
        // Xagent (APT28)
        Entry(domain: "apple-checker.org", family: "Xagent"),
    ]
}
